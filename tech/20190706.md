# Mac ä¸‹ä¿®æ”¹ åç¡•è·¯ç”±å™¨ æ¢…æ—å›ºä»¶ hosts æ•™ç¨‹

> å‰æï¼šå·²åˆ·æ¢…æ—å›ºä»¶ï¼ˆ[å›ºä»¶ä¸‹è½½&åˆ·æœºæ•™ç¨‹](https://koolshare.cn/forum.php?mod=forumdisplay&fid=96&filter=typeid&typeid=68&orderby=lastpost)ï¼‰ã€‚å¦åˆ™æ— æ³•ä¿®æ”¹ hostsã€‚

## è·¯ç”±å™¨å¼€å¯ SSH

> SSH é€šé“å¯ä»¥è®©æˆ‘ä»¬å¯ä»¥è¿œç¨‹è®¿é—®è·¯ç”±æ–‡ä»¶ã€‚

**ç¬¬ä¸€æ­¥ï¼š** å¼€å¯ SSH

æ‰“å¼€è·¯ç”±ç®¡ç†åå°ï¼ˆåç¡•é»˜è®¤ä¸º 192.168.50.1ï¼‰ã€‚
è¿›å…¥ç³»ç»Ÿç®¡ç† - ç³»ç»Ÿè®¾ç½® - æœåŠ¡ã€‚Enable SSH é€‰æ‹© `LAN only`(ä»…å†…ç½‘è®¿é—®)ï¼Œå…¶ä»–æŒ‰ç…§ä»¥ä¸‹æˆªå›¾é…ç½®å³å¯ã€‚

![ssh](../assets/20190706/ssh_0.png)

**ç¬¬äºŒæ­¥ï¼š** è¿æ¥ SSH

æ‰“å¼€ Mac ç»ˆç«¯ï¼ˆå¦‚æœä¸çŸ¥é“ç»ˆç«¯æ˜¯å•¥ï¼Œå¯ä»¥ cmd + ç©ºæ ¼ï¼Œæœç´¢ï¼šç»ˆç«¯.appï¼‰ã€‚

è¾“å…¥ï¼š

```bash
# æ ¼å¼: ssh {ä½ çš„è·¯ç”±å™¨ç”¨æˆ·åï¼Œé»˜è®¤ä¸ºadmin}@{ä½ çš„è·¯ç”±å™¨ipåœ°å€}
ssh admin@192.168.50.1
```

ç¡®è®¤åä¼šè®©ä½ è¾“å…¥è·¯ç”±å™¨ç®¡ç†åå°å¯†ç ï¼ˆä¸æ˜¯wifiå¯†ç ï¼‰ã€‚è¾“å…¥å¯†ç æ—¶æ˜¯æ²¡æœ‰å­—ç¬¦æç¤ºçš„ï¼Œä½†æ˜¯å­—ç¬¦æ˜¯è¾“å…¥äº†çš„ï¼ˆå‘½ä»¤è¡Œçš„ä¸–ç•Œé‡Œï¼Œæ²¡æœ‰æ¶ˆæ¯å°±æ˜¯å¥½æ¶ˆæ¯ï¼‰ï¼Œè¾“å®ŒæŒ‰`Enter`ç¡®è®¤ã€‚

æˆåŠŸè¿æ¥åï¼Œä½ å°±è¿›å…¥åˆ°è·¯ç”±çš„æ–‡ä»¶ç³»ç»Ÿå•¦(ï½¡ï½¥Ï‰ï½¥)ï¾‰

![ssh](../assets/20190706/ssh_1.png)

## ä¿®æ”¹ hosts

> è¿™é‡Œå°†ç”¨åˆ°ä¸€äº›ç®€å•çš„ shell å‘½ä»¤ã€‚

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ scp ä¸Šä¼ æ–‡ä»¶

**ç¬¬ä¸€æ­¥ï¼š** åˆ›å»ºæ–‡ä»¶

åœ¨ Mac æœ¬åœ°æ–°å»ºä¸¤ä¸ªç©ºç™½æ–‡æœ¬æ–‡ä»¶ï¼Œé‡å‘½åä¸º `dnsmasq.conf.add`ï¼Œ`hosts`ã€‚

ä½¿ç”¨ä½ å–œæ¬¢çš„æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å¹¶ç¼–è¾‘ `dnsmasq.conf.add`ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š

```txt
addn-hosts=/jffs/configs/hosts
```

`hosts` æ–‡ä»¶ä¸­åˆ™å†™å…¥ä½ çš„ hostsã€‚

**ç¬¬äºŒæ­¥ï¼š** ä¸Šä¼ æ–‡ä»¶

> Mac ä¸‹è‡ªå¸¦ scp å‘½ä»¤ï¼Œæ— éœ€å®‰è£…å…¶ä»–ä¸œè¥¿ã€‚

```
# æ ¼å¼ä¸ºï¼šscp {æ–‡ä»¶è·¯å¾„} {è·¯ç”±å™¨ç”¨æˆ·å}@{è·¯ç”±å™¨ip}:{è¦ä¸Šä¼ çš„è·¯å¾„}
```

åœ¨ç»ˆç«¯ä¸­æŒ‰ `cmd+n` æ–°å»ºä¸€ä¸ªç»ˆç«¯çª—å£ã€‚

å…ˆè¾“å…¥ `scp `ï¼Œç„¶åå°† `dnsmasq.conf.add` æ–‡ä»¶æ‹–è¿›ç»ˆç«¯ï¼ˆä¼šè‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶è·¯å¾„ï¼‰ï¼Œå†è¾“å…¥`admin@192.168.50.1:/jffs/`ï¼Œç¡®è®¤ï¼Œè¾“å…¥è·¯ç”±å™¨åå°ç®¡ç†å¯†ç å³å¯ã€‚

`hosts` ä¹Ÿæ˜¯ä¸€æ ·æ“ä½œï¼Œä½†æ˜¯ä¸Šä¼ è·¯å¾„ä¸º `/jffs/configs/`ã€‚

![scp](../assets/20190706/scp_0.png)

**ç¬¬ä¸‰æ­¥ï¼š** é‡å¯ dnsmasq æœåŠ¡

> è¿™ä¸€æ­¥ä»¤ä¿®æ”¹çš„ hosts ç«‹å³ç”Ÿæ•ˆã€‚

åœ¨åˆšæ‰çš„ SSH çª—å£ï¼Œè¾“å…¥ï¼š

```bash
service restart_dnsmasq
```

![scp](../assets/20190706/scp_1.png)

å¤§åŠŸæ”¹æˆğŸ‰ï¼

### æ–¹æ³•äºŒï¼šä½¿ç”¨ vim ç¼–è¾‘æ–‡ä»¶

**ç¬¬ä¸€æ­¥ï¼š** åˆ›å»º dnsmasq.conf.add

ä¾æ¬¡è¾“å…¥ï¼š

```bash
# å›åˆ°ç›®å½•é¡¶å±‚
cd /
# åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨
ls
# è¿›å…¥ jffs ç›®å½•
cd jffs
# åˆ›å»ºæ–‡ä»¶ dnsmasq.conf.add
touch dnsmasq.conf.add

# è¿›å…¥ vim ç¼–è¾‘æ–‡ä»¶
vi dnsmasq.conf.add
# è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼ˆä¹‹åæ‰èƒ½è¾“å…¥ï¼‰
i
```
![vim](../assets/20190706/vim_0.png)

å°†ä»¥ä¸‹å†…å®¹ç²˜è´´è¿›ç»ˆç«¯ï¼š

```txt
addn-hosts=/jffs/configs/hosts
```

![vim](../assets/20190706/vim_1.png)

ç¼–è¾‘å®Œæˆåï¼ŒæŒ‰é”®ç›˜å·¦ä¸Šè§’çš„`esc`é€€å‡ºç¼–è¾‘æ¨¡å¼ã€‚ç„¶åä¿å­˜é€€å‡º vimï¼š

```bash
# ä¿å­˜å¹¶é€€å‡º vimï¼ˆæŒ‰ä½ shift + zzï¼‰
ZZ
# æŸ¥çœ‹æ–‡ä»¶ï¼Œçœ‹ä¸‹æ˜¯å¦ç¬¦åˆé¢„æœŸ
cat dnsmasq.conf.add
```

![vim](../assets/20190706/vim_2.png)

**ç¬¬äºŒæ­¥ï¼š** åˆ›å»º hosts

å’Œç¬¬ä¸€æ­¥åŒç†ï¼Œåœ¨ `/jffs/configs/` ç›®å½•ä¸‹åˆ›å»ºä¿®æ”¹ `hosts` æ–‡ä»¶ã€‚
ä¸å†èµ˜è¿°ã€‚

**ç¬¬ä¸‰æ­¥ï¼š** é‡å¯ dnsmasq æœåŠ¡

> è¿™ä¸€æ­¥ä»¤ä¿®æ”¹çš„ hosts ç«‹å³ç”Ÿæ•ˆã€‚

åœ¨åˆšæ‰çš„ SSH çª—å£ï¼Œè¾“å…¥ï¼š

```bash
service restart_dnsmasq
```

![vim](../assets/20190706/vim_3.png)

å¤§åŠŸæ”¹æˆğŸ‰ï¼

## å¦™ç”¨ hosts

### è®¾ç½®è®¿é—®åˆ«å

```
192.168.50.1 momo.com
```

ä¾‹å¦‚ç»™è·¯ç”±å™¨åå°åœ°å€è®¾ç½®ä¸€ä¸ªåŸŸåï¼Œè¿™æ ·æˆ‘ä»¬åœ¨å†…ç½‘ä¸‹ï¼Œç›´æ¥è®¿é—®è¿™ä¸ªåŸŸåå°±å¯ä»¥è¿›å…¥è·¯ç”±å™¨ã€‚

### å±è”½è½¯ä»¶æ›´æ–°

å±è”½é”¤å­æ‰‹æœºç³»ç»Ÿæ›´æ–°ï¼š

```
172.0.0.1 ota2.smartisan.com
172.0.0.1 ota.smartisan.com
```

å±è”½ Mac è¿…é›·æ›´æ–°ï¼š

```
127.0.0.1 liveupdate.mac.sandai.net
127.0.0.1 windows10.microdone.cn
```

### å±è”½å¹¿å‘Š

[å±è”½å°ç±³ç”µè§†/ç›’å­å¼€æœºå¹¿å‘Š hosts](https://gist.github.com/itspig/e22bd240cff35fbb4b29fafd2539de27)

## æ€»ç»“

æ¢…æ—å›ºä»¶è¿™ä¹ˆä¹…ï¼Œå±…ç„¶éƒ½æ²¡æœ‰ç›´æ¥ä¿®æ”¹ hosts çš„æ’ä»¶(à²¥_à²¥)ã€‚

æŠ˜è…¾è·¯ç”±ï¼Œå…¶ä¹æ— ç©·O(âˆ©_âˆ©)Oã€‚
